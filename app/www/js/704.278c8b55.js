"use strict";(self["webpackChunk_coreui_coreui_free_vue_admin_template"]=self["webpackChunk_coreui_coreui_free_vue_admin_template"]||[]).push([[704],{52766:(e,t,n)=>{n.d(t,{Z:()=>s});n(57658);var a=n(97993),r=function(){localStorage.getItem("token")||a.Z.push({name:"Login"})};const s=r},69704:(e,t,n)=>{n.r(t),n.d(t,{default:()=>g});n(68309);var a=n(73396),r=n(87139),s=function(e){return(0,a.dD)("data-v-2fecdf70"),e=e(),(0,a.Cn)(),e},o=s((function(){return(0,a._)("h1",null,"Settings",-1)})),u={class:"mb-3"},i={class:"mb-3"},l={class:"mb-3"},d={class:"mb-3"};function c(e,t,n,s,c,m){var f=(0,a.up)("CCol"),w=(0,a.up)("CRow"),p=(0,a.up)("CFormLabel"),b=(0,a.up)("CFormInput"),h=(0,a.up)("CFormText"),k=(0,a.up)("CForm"),_=(0,a.up)("CAlert"),g=(0,a.up)("CButton"),W=(0,a.up)("CSpinner"),v=(0,a.up)("CModalBody"),C=(0,a.up)("CModalFooter"),U=(0,a.up)("CModal"),x=(0,a.up)("CIcon"),y=(0,a.up)("CToastHeader"),V=(0,a.up)("CToastBody"),I=(0,a.up)("CToast"),Z=(0,a.up)("CToaster"),P=(0,a.up)("CContainer");return(0,a.wg)(),(0,a.j4)(P,null,{default:(0,a.w5)((function(){return[(0,a.Wm)(w,null,{default:(0,a.w5)((function(){return[(0,a.Wm)(f,null,{default:(0,a.w5)((function(){return[o]})),_:1})]})),_:1}),(0,a.Wm)(w,null,{default:(0,a.w5)((function(){return[(0,a.Wm)(f,null,{default:(0,a.w5)((function(){return[(0,a.Wm)(k,null,{default:(0,a.w5)((function(){return[(0,a._)("div",u,[(0,a.Wm)(p,{for:"InputName1"},{default:(0,a.w5)((function(){return[(0,a.Uk)("Name")]})),_:1}),(0,a.Wm)(b,{disabled:!c.enabled,type:"text",id:"InputName1","aria-describedby":"NameHelp",name:"name",modelValue:c.name,"onUpdate:modelValue":t[0]||(t[0]=function(e){return c.name=e})},null,8,["disabled","modelValue"]),(0,a.Wm)(h,{id:"NameHelp"},{default:(0,a.w5)((function(){return[(0,a.Uk)("This could not be used for searching.")]})),_:1})]),(0,a._)("div",i,[(0,a.Wm)(p,{for:"InputUsername1"},{default:(0,a.w5)((function(){return[(0,a.Uk)("Username")]})),_:1}),(0,a.Wm)(b,{disabled:!c.enabled,type:"text",id:"InputUsername1","aria-describedby":"UsernameHelp",name:"username",modelValue:c.username,"onUpdate:modelValue":t[1]||(t[1]=function(e){return c.username=e})},null,8,["disabled","modelValue"]),(0,a.Wm)(h,{id:"UsernameHelp"},{default:(0,a.w5)((function(){return[(0,a.Uk)("Your username must be unique.")]})),_:1})]),(0,a._)("div",l,[(0,a.Wm)(p,{for:"InputEmail1"},{default:(0,a.w5)((function(){return[(0,a.Uk)("Email address")]})),_:1}),(0,a.Wm)(b,{disabled:!c.enabled,type:"email",id:"InputEmail1","aria-describedby":"emailHelp",name:"email",modelValue:c.email,"onUpdate:modelValue":t[2]||(t[2]=function(e){return c.email=e})},null,8,["disabled","modelValue"]),(0,a.Wm)(h,{id:"emailHelp"},{default:(0,a.w5)((function(){return[(0,a.Uk)("Your email must be unique.")]})),_:1})])]})),_:1})]})),_:1})]})),_:1}),c.error?((0,a.wg)(),(0,a.j4)(_,{key:0,color:"danger"},{default:(0,a.w5)((function(){return[(0,a.Uk)((0,r.zw)(c.error),1)]})),_:1})):(0,a.kq)("",!0),(0,a.Wm)(w,{class:"mt-3"},{default:(0,a.w5)((function(){return[(0,a.Wm)(f,{xs:"12",sm:"6",class:"mb-2"},{default:(0,a.w5)((function(){return[(0,a.Wm)(g,{color:"primary",class:"w-100 text-white",onClick:t[3]||(t[3]=function(e){return c.modalVisible=!0}),disabled:c.enabled},{default:(0,a.w5)((function(){return[(0,a.Uk)(" Edit")]})),_:1},8,["disabled"])]})),_:1}),(0,a.Wm)(f,{xs:"12",sm:"6",class:"mb-2"},{default:(0,a.w5)((function(){return[c.waiting?((0,a.wg)(),(0,a.j4)(g,{key:1,color:"primary",class:"w-100 text-white",disabled:""},{default:(0,a.w5)((function(){return[(0,a.Wm)(W,{size:"sm"})]})),_:1})):((0,a.wg)(),(0,a.j4)(g,{key:0,color:"primary",class:"w-100 text-white",disabled:!c.enabled,onClick:m.saveChanges},{default:(0,a.w5)((function(){return[(0,a.Uk)(" Save")]})),_:1},8,["disabled","onClick"]))]})),_:1})]})),_:1}),(0,a.Wm)(U,{visible:c.modalVisible,onClose:t[6]||(t[6]=function(){c.modalVisible=!1})},{default:(0,a.w5)((function(){return[(0,a.Wm)(v,null,{default:(0,a.w5)((function(){return[(0,a.Uk)("Please enter your password to confirm the changes.")]})),_:1}),(0,a.Wm)(C,null,{default:(0,a.w5)((function(){return[(0,a.Wm)(k,null,{default:(0,a.w5)((function(){return[(0,a._)("div",d,[(0,a.Wm)(p,{for:"InputPassword1"},{default:(0,a.w5)((function(){return[(0,a.Uk)("Password")]})),_:1}),(0,a.Wm)(b,{type:"password",id:"InputPassword1","aria-describedby":"PasswordHelp",name:"password",modelValue:c.password,"onUpdate:modelValue":t[4]||(t[4]=function(e){return c.password=e})},null,8,["modelValue"]),(0,a.Wm)(h,{id:"PasswordHelp"},{default:(0,a.w5)((function(){return[(0,a.Uk)("Your password must be 8-20 characters long, contain letters and numbers, and must not contain spaces, special characters, or emoji.")]})),_:1})])]})),_:1}),c.error?((0,a.wg)(),(0,a.j4)(_,{key:0,color:"danger",class:"w-100"},{default:(0,a.w5)((function(){return[(0,a.Uk)((0,r.zw)(c.error),1)]})),_:1})):(0,a.kq)("",!0),(0,a.Wm)(g,{color:"secondary",onClick:t[5]||(t[5]=function(){c.modalVisible=!1})},{default:(0,a.w5)((function(){return[(0,a.Uk)(" Cancel ")]})),_:1}),c.waiting?((0,a.wg)(),(0,a.j4)(g,{key:2,color:"primary",class:"text-white",onClick:m.enableFields},{default:(0,a.w5)((function(){return[(0,a.Wm)(W,{size:"sm"}),(0,a.Uk)(" Validating... ")]})),_:1},8,["onClick"])):((0,a.wg)(),(0,a.j4)(g,{key:1,color:"primary",class:"text-white",onClick:m.enableFields},{default:(0,a.w5)((function(){return[(0,a.Uk)("Verify")]})),_:1},8,["onClick"]))]})),_:1})]})),_:1},8,["visible"]),c.toastVisible?((0,a.wg)(),(0,a.j4)(Z,{key:1,style:{position:"absolute",bottom:"5px",right:"5px","z-index":"9999"}},{default:(0,a.w5)((function(){return[(0,a.Wm)(I,{show:c.toastVisible,autohide:"true",fade:"true",onHide:t[7]||(t[7]=function(e){return c.toastVisible=!1})},{default:(0,a.w5)((function(){return[(0,a.Wm)(y,null,{default:(0,a.w5)((function(){return[(0,a.Wm)(x,{name:"cil-check-circle",class:"me-2"}),(0,a.Uk)(" Success ")]})),_:1}),(0,a.Wm)(V,null,{default:(0,a.w5)((function(){return[(0,a.Uk)(" Your changes have been saved. ")]})),_:1})]})),_:1},8,["show"])]})),_:1})):(0,a.kq)("",!0)]})),_:1})}var m=n(82482),f=n(50124),w=n(48534),p=(n(21703),n(96647),n(47941),n(52766)),b=n(44161);const h=(0,m.Z)({data:function(){return{screenWidth:window.innerWidth,enabled:!1,waiting:!1,name:"",username:"",email:"",password:"",modalVisible:!1,error:"",toastVisible:!1}},mounted:function(){window.addEventListener("resize",this.handleResize)},methods:{handleResize:function(){this.screenWidth=window.innerWidth},enableFields:function(){var e=this;return(0,w.Z)((0,f.Z)().mark((function t(){var n,a;return(0,f.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.waiting=!0,console.log("".concat(e.$store.state.API_URL,"/users")),t.prev=2,""!==e.password){t.next=5;break}throw new Error("Password is required");case 5:return t.next=7,b.Z.get("".concat(e.$store.state.API_URL,"/users"),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});case 7:return n=t.sent,t.next=10,b.Z.post("".concat(e.$store.state.API_URL,"/auth/login"),{username:n.data.username,password:e.password});case 10:if(a=t.sent,!a.data.token){t.next=22;break}e.enabled=!0,e.modalVisible=!1,e.waiting=!1,localStorage.setItem("token",a.data.token),e.name=n.data.name,e.username=n.data.username,e.email=n.data.email,e.password="",t.next=25;break;case 22:throw e.waiting=!1,e.username="",new Error("Password is incorrect");case 25:e.enabled=!0,e.modalVisible=!1,t.next=33;break;case 29:t.prev=29,t.t0=t["catch"](2),e.waiting=!1,e.error=t.t0.response?t.t0.response.data.message:t.t0.message;case 33:case"end":return t.stop()}}),t,null,[[2,29]])})))()},saveChanges:function(){var e=this;return(0,w.Z)((0,f.Z)().mark((function t(){var n,a;return(0,f.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,e.waiting=!0,""!==e.name){t.next=4;break}throw new Error("Name is required");case 4:if(""!==e.username){t.next=6;break}throw new Error("Username is required");case 6:if(""!==e.email){t.next=8;break}throw new Error("Email is required");case 8:return e.$store.commit({type:"setName",value:e.name}),t.next=11,b.Z.get("".concat(e.$store.state.API_URL,"/users"),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});case 11:if(n=t.sent,a={name:e.$store.state.name,username:e.username,email:e.email},console.log(n.data.name,e.name),n.data.name===e.name&&delete a.name,n.data.username===e.username&&delete a.username,n.data.email===e.email&&delete a.email,0!==Object.keys(a).length){t.next=19;break}throw new Error("No changes were made");case 19:return t.next=21,b.Z.patch("".concat(e.$store.state.API_URL,"/users"),a,{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});case 21:t.sent,e.waiting=!1,e.enabled=!1,e.error="",e.password="",e.toastVisible=!0,t.next=33;break;case 29:t.prev=29,t.t0=t["catch"](0),e.waiting=!1,e.error=t.t0.response?t.t0.response.data.message:t.t0.message;case 33:case"end":return t.stop()}}),t,null,[[0,29]])})))()}},beforeMount:function(){(0,p.Z)()}},"mounted",(function(){var e=this;return(0,w.Z)((0,f.Z)().mark((function t(){var n;return(0,f.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,b.Z.get("".concat(e.$store.state.API_URL,"/users"),{headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});case 2:n=t.sent,e.name=n.data.name,e.username=n.data.username,e.email=n.data.email;case 6:case"end":return t.stop()}}),t)})))()}));var k=n(40089);const _=(0,k.Z)(h,[["render",c],["__scopeId","data-v-2fecdf70"]]),g=_}}]);
//# sourceMappingURL=704.278c8b55.js.map